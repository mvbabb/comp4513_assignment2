<!DOCTYPE html>
<html>
    <head>
        <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">

        <!-- css -->
        <link rel="stylesheet" href="../YLN_app/style.css">
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.1/jquery.min.js"></script>
        <!-- Latest compiled and minified JavaScript -->
        <link href="//maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css" rel="stylesheet"> 
        <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>
        <title>YourLiveNews</title>



        <script>
            $(document).ready(function () {
                
                loadFeed("buzzfeed");
                
                
                

                $.ajax({
                    url: "https://newsapi.org/v1/sources?language=en",
                    dataType: 'json',
                    type: 'GET',
                    success: function (data) {
                        var sourceString = "";
                        var sourceTarget = document.querySelector(".sourceList");
                        var sources = data.sources;
                        for (var i = 0; i < sources.length; i++) {
                            var source = sources[i];
                            var sourceHtmlString = '<li><a class="sourceLink" title="' + source.id + '">' + source.name + '</a></li>';
                            sourceString += sourceHtmlString;
                        }
                        $(sourceString).appendTo(sourceTarget);
                        //alert(sourceString);

                        $('a.sourceLink').on('click', function (e) {
                            e.preventDefault();
                            var source = $(this).attr('title');
                            $('#newsFeed').html("");
                            loadFeed(source);
                        });
                    }
                });



                function loadFeed(source){
                     $.ajax({
                    url: "https://newsapi.org/v1/articles?source=" + source + "&apiKey=f507ff22dca54c43b92817017a34d613",
                    dataType: 'json',
                    type: 'GET',
                    success: function (data) {
                        var htmlString = "";
                        var articles = data.articles;
                        for (var i = 0; i < articles.length; i++) {
                            var article = articles[i];
                            var articleHtmlString = "<div class='panel panel-default'>";
                            articleHtmlString += "<div class='panel-body'>";
                            articleHtmlString += "<div class='media'><div class='media-left media-middle'>";
                            articleHtmlString += "<img src='" + article["urlToImage"] + "' class='media-object' style='width:100px'></div>";
                            articleHtmlString += "<div class='media-body'><h4 class='media-heading'>";
                            articleHtmlString += "<a href='" + article["url"] + "'>" + article["title"] + "</a></h4>";
                            articleHtmlString += "<p>" + article["description"] + "</p>";
                            articleHtmlString += "</div><div class='media-right media-middle'><img src='http://i.newsapi.org/associated-press-s.png' width='60px'></div></div></div></div>";
                            htmlString += articleHtmlString;
                        }
                        //console.log(htmlString);
                        //$(htmlString).insertBefore($("footer"));
                        $('#newsFeed').append(htmlString);

                    }});
                }












            });












        </script>
    </head>

    <body>
        <header>
            <nav class="navbar navbar-inverse">
                <div class="container-fluid">
                    <div class="navbar-header">
                        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#myNavbar">
                            <span class="icon-bar"></span>
                            <span class="icon-bar"></span>
                            <span class="icon-bar"></span>                        
                        </button>
                        <a class="navbar-brand" href="#"><img src="../YLN_app/YourLiveNews_White.png"></a>
                    </div>
                    <div class="collapse navbar-collapse" id="myNavbar">
                        <ul class="nav navbar-nav">
                            <li class="active"><a href="#">Home</a></li>
                            <li class="dropdown">
                                <a class="dropdown-toggle" data-toggle="dropdown" href="#">Sources<span class="caret"></span></a>
                                <ul class="dropdown-menu " role="menu">
                                </ul>
                            </li>
                            <li><a href="#">Pricing</a></li>
                            <li><a href="#">About</a></li>
                            <li><a href="http://localhost:3001/secure">Settings</a></li>
                            <li><a href="http://localhost:3001/newsfeed">NewsFeed</a></li>
                        </ul>
                        <form class="navbar-form navbar-right">
                            <div class="form-group">
                                <input type="text" class="form-control" placeholder="Search">
                            </div>
                            <button type="submit" class="btn btn-default">Search</button>
                        </form>
                    </div>
                </div>
            </nav>
        </header>

        <div class="col-md-1">
            <div class="dropdown dropped favorite_drops">
                <button class="btn btn-primary dropdown-toggle" type="button" data-toggle="dropdown">Sources
                    <span class="caret"></span></button>
                <ul class="dropdown-menu sourceList scrollable-menu">

                </ul>
            </div> 
            <div class="dropdown dropped favorite_drops">
                <button class="btn btn-primary dropdown-toggle" type="button" data-toggle="dropdown">Topics
                    <span class="caret"></span></button>
                <ul class="dropdown-menu">
                    <li><a href="#">Business</a></li>
                    <li><a href="#">Entertainment</a></li>
                    <li><a href="#">Gaming</a></li>
                    <li><a href="#">General</a></li>
                    <li><a href="#">Music</a></li>
                    <li><a href="#">Science and Nature</a></li>
                    <li><a href="#">Sport</a></li>
                    <li><a href="#">Technology</a></li>


                </ul>
            </div> 
            <div class="dropdown dropped favorite_drops">
                <button class="btn btn-primary dropdown-toggle" type="button" data-toggle="dropdown">Favorite Sources
                    <span class="caret"></span></button>
                <ul class="dropdown-menu">
                    <li><a href="#">Tech</a></li>
                    <li><a href="#">Politics</a></li>

                </ul>
            </div> 
            <div class="dropdown dropped favorite_drops">
                <button class="btn btn-primary dropdown-toggle" type="button" data-toggle="dropdown">Favorite Stories
                    <span class="caret"></span></button>
                <ul class="dropdown-menu">
                    <li><a href="#">Tech</a></li>
                    <li><a href="#">Politics</a></li>

                </ul>
            </div> 

        </div>
        
        <div id="newsFeed">


        <!-- This is where the live feed goes, each panel is a new article 
            
            <div class="panel panel-default">
                <div class="panel-body">
                    <div class="media">
                        <div class="media-left media-middle">
                            <img src="https://tctechcrunch2011.files.wordpress.com/2017/03/solar-panel-tesla-kauai.jpg?w=764&h=400&crop=1" class="media-object" style="width:100px">
                        </div>
 
                        <div class="media-body">
                            <h4 class="media-heading"><a href="https://techcrunch.com/2017/03/10/teslas-kauai-solar-storage-facility-offers-a-glimpse-of-the-companys-future/">Tesla's Kauai solar storage facility offers a glimpse of the company's future</a></h4>
                            <p>Tesla's solar installation on the Hawaiian island of Kauai is not just a product launch of the company - it's the first real proof the company's offering up..</p> 
                        </div>
                                                 <div class="media-right media-middle">
    <img src="http://i.newsapi.org/associated-press-s.png" width="60px">
  </div>
                    </div>
                </div>
            </div> 
-->
        <!-- This is the end of the first article -->
        
        </div>

    <footer>
        <nav class="navbar navbar-inverse navbarbottommargin navbar-bottom">
            <div class="container-fluid">
                <div class="navbar-bottom">
                    <a class="navbar-brand" href="#"><img src="../YLN_app/YourLiveNews_White.png"></a>
                </div>
                <p class="text-right powered-by">Powered by: <a href="newsapi.org">NewsApi.org</a></p>
                <!-- <ul class="nav navbar-nav">
                   <li class="active"><a href="#">Home</a></li>
                   <li><a href="#">Page 1</a></li>
                   <li><a href="#">Page 2</a></li>
                   <li><a href="#">Page 3</a></li>
                 </ul>-->
            </div>
        </nav> 
    </footer>

    </body>
</html>